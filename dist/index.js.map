{"version":3,"sources":["../src/index.ts","../src/infra/fs.ts","../src/infra/yaml.ts","../src/services/iupipes.ts","../src/services/detect.ts","../src/services/runtime.ts","../src/services/plan.ts"],"sourcesContent":["import * as core from \"@actions/core\";\n\nimport { IuPipesReader } from \"./services/iupipes.js\";\nimport { RuntimeDetector } from \"./services/detect.js\";\nimport { RuntimeVersionResolver } from \"./services/runtime.js\";\nimport { PlanBuilder } from \"./services/plan.js\";\nimport type { Goal, Runtime } from \"./domain/types.js\";\n\nfunction normalizeWorkingDir(wd: string | undefined): string {\n  const raw = (wd ?? \".\").trim();\n  const cleaned = raw.replace(/\\\\/g, \"/\").replace(/\\/+$/g, \"\");\n  return cleaned.length ? cleaned : \".\";\n}\n\nfunction normalizeGoal(g: string | undefined): Goal {\n  const v = (g ?? \"ci\").toLowerCase().trim();\n  if (v === \"pr-check\" || v === \"ci\" || v === \"release\") return v;\n  return \"ci\";\n}\n\nfunction normalizeRuntime(r: string | undefined): Runtime | \"auto\" {\n  const v = (r ?? \"auto\").toLowerCase().trim();\n  if (v === \"auto\") return \"auto\";\n  if (v === \"node\" || v === \"java\" || v === \"python\" || v === \"go\") return v;\n  return \"auto\";\n}\n\nasync function run(): Promise<void> {\n  try {\n    const workspace = process.env.GITHUB_WORKSPACE ?? process.cwd();\n\n    const cfg = IuPipesReader.read(workspace);\n    const project = cfg.project ?? {};\n\n    const workingDirectory = normalizeWorkingDir(project[\"working-directory\"]);\n    const goal = normalizeGoal(project.goal);\n\n    // runtime\n    let runtime = normalizeRuntime(project.runtime);\n    if (runtime === \"auto\") {\n      runtime = RuntimeDetector.detect(workspace, workingDirectory);\n    }\n\n    // version\n    let rv = (project[\"runtime-version\"] ?? \"auto\").toString().trim().toLowerCase();\n    const runtimeVersion =\n      rv === \"auto\" || rv === \"\"\n        ? RuntimeVersionResolver.resolve({ workspace, workingDirectory, runtime })\n        : RuntimeVersionResolver.normalize(rv);\n\n    const { plan, matrix } = PlanBuilder.build({\n      workspace,\n      workingDirectory,\n      runtime,\n      runtimeVersion,\n      goal,\n      project\n    });\n\n    // outputs core\n    core.setOutput(\"runtime\", runtime);\n    core.setOutput(\"runtime_version\", runtimeVersion);\n    core.setOutput(\"working_directory\", workingDirectory);\n    core.setOutput(\"plan_json\", JSON.stringify(plan));\n    core.setOutput(\"matrix\", JSON.stringify(matrix));\n\n    // phase outputs\n    core.setOutput(\"cmd_pre_install\", plan.phases.pre_install.join(\"\\n\"));\n    core.setOutput(\"cmd_install\", plan.phases.install.join(\"\\n\"));\n    core.setOutput(\"cmd_pre_build\", plan.phases.pre_build.join(\"\\n\"));\n    core.setOutput(\"cmd_build\", plan.phases.build.join(\"\\n\"));\n    core.setOutput(\"cmd_test\", plan.phases.test.join(\"\\n\"));\n    core.setOutput(\"cmd_post\", plan.phases.post.join(\"\\n\"));\n\n    core.info(`runtime=${runtime}`);\n    core.info(`runtime_version=${runtimeVersion}`);\n    core.info(`working_directory=${workingDirectory}`);\n    core.info(`goal=${goal}`);\n  } catch (e: any) {\n    core.setFailed(e?.message ?? String(e));\n  }\n}\n\nvoid run();\n","import fs from \"node:fs\";\nimport path from \"node:path\";\n\nexport const fileExists = (p: string): boolean => {\n    try {\n        return fs.existsSync(p);\n    } catch {\n        return false;\n    }\n};\n\nexport const readText = (p: string): string | null => {\n    try {\n        return fs.readFileSync(p, \"utf8\");\n    } catch {\n        return null;\n    }\n};\n\nexport const listDir = (dir: string): string[] => {\n    try {\n        return fs.readdirSync(dir);\n    } catch {\n        return [];\n    }\n}\n\nexport const join = path.join;","import yaml from \"js-yaml\";\nimport type { IuPipesConfig } from \"../domain/types\";\n\nexport function parseYaml(text: string): IuPipesConfig {\n    const obj = yaml.load(text);\n    if (!obj || typeof obj !== \"object\") return {};\n    return obj as IuPipesConfig;\n}","import { join, readText } from \"../infra/fs\";\nimport { parseYaml } from \"../infra/yaml\";\nimport type { IuPipesConfig } from \"../domain/types\";\n\nexport class IuPipesReader {\n    public static read(workspace: string): IuPipesConfig {\n        const p = join(workspace, \".iupipes.yml\");\n        const raw = readText(p);\n        if (!raw) return {};\n        return parseYaml(raw);\n    }\n}","import { fileExists, join, listDir } from \"../infra/fs\";\nimport type { Runtime } from \"../domain/types\";\n\nexport class RuntimeDetector {\n  public static detect(workspace: string, workingDirectory: string): Runtime {\n    const bases = [join(workspace, workingDirectory), workspace];\n\n    for (const base of bases) {\n        // go\n        if (fileExists(join(base, \"go.mod\"))) return \"go\";\n\n        // node\n        if (fileExists(join(base, \"package.json\"))) return \"node\";\n\n        // java / kotlin (maven/gradle)\n        if (fileExists(join(base, \"pom.xml\"))) return \"java\";\n        if (fileExists(join(base, \"build.gradle\")) || fileExists(join(base, \"build.gradle.kts\"))) return \"java\";\n        if (fileExists(join(base, \"settings.gradle\")) || fileExists(join(base, \"settings.gradle.kts\"))) return \"java\";\n\n        // python\n        if (fileExists(join(base, \"pyproject.toml\"))) return \"python\";\n        if (fileExists(join(base, \"requirements.txt\"))) return \"python\";\n        const files = listDir(base);\n        if (files.some(f => /^requirements.*\\.txt$/i.test(f))) return \"python\";\n        if (fileExists(join(base, \"setup.py\")) || fileExists(join(base, \"Pipfile\"))) return \"python\";\n    }\n\n    throw new Error(\"Unable to detect runtime. Add project.runtime in .iupipes.yml or add a recognizable config file.\");\n  }\n}","import { join, readText } from \"../infra/fs\";\nimport type { Runtime } from \"../domain/types\";\n\nexport class RuntimeVersionResolver {\n  public static resolve(params: {\n    workspace: string;\n    workingDirectory: string;\n    runtime: Runtime;\n  }): string {\n    const { workspace, workingDirectory, runtime } = params;\n    const wd = join(workspace, workingDirectory);\n\n    const tryRead = (rel: string): string | null => {\n      return readText(join(wd, rel)) ?? readText(join(workspace, rel));\n    };\n\n    if (runtime === \"node\") {\n      const nvmrc = tryRead(\".nvmrc\");\n      if (nvmrc) {\n        const v = nvmrc.trim().replace(/^v/i, \"\").replace(/\\.x$/i, \"\");\n        if (v) return v;\n      }\n      const pkgRaw = tryRead(\"package.json\");\n      if (pkgRaw) {\n        try {\n          const pkg = JSON.parse(pkgRaw) as any;\n          const eng: unknown = pkg?.engines?.node;\n          if (typeof eng === \"string\") {\n            const m = eng.match(/(\\d{2})/);\n            if (m) return m[1];\n          }\n        } catch {\n          // ignore\n        }\n      }\n      return \"20\";\n    }\n\n    if (runtime === \"go\") {\n      const gomod = tryRead(\"go.mod\");\n      if (gomod) {\n        const m = gomod.match(/^\\s*go\\s+(\\d+\\.\\d+)\\s*$/m);\n        if (m) return m[1];\n      }\n      return \"1.22\";\n    }\n\n    if (runtime === \"python\") {\n      const pyv = tryRead(\".python-version\");\n      if (pyv && pyv.trim()) return pyv.trim();\n      return \"3.11\";\n    }\n\n    // java\n    return \"17\";\n  }\n\n  public static normalize(version: string): string {\n    return version.trim().replace(/^v/i, \"\").replace(/\\.x$/i, \"\");\n  }\n}","import { fileExists, join, listDir } from \"../infra/fs.js\";\nimport type { Goal, Phases, Plan, Runtime, Matrix } from \"../domain/types.js\";\n\nexport class PlanBuilder {\n    public static build(params: {\n        workspace: string;\n        workingDirectory: string;\n        runtime: Runtime;\n        runtimeVersion: string;\n        goal: Goal;\n        project?: any;\n    }): { plan: Plan; matrix: Matrix} {\n        const { workspace, workingDirectory, runtime, runtimeVersion, goal, project } = params;\n        const phases = this.buildPhases({ workspace, workingDirectory, runtime, goal });\n\n        const plan: Plan = {\n            version: 1,\n            detected: { runtime, runtimeVersion, workingDirectory, goal },\n            project,\n            phases,\n            artifacts: this.defaultArtifacts(runtime)\n        };\n\n        const matrix: Matrix = {\n            include: [\n                { step_name: \"PRE-INSTALL\", stage: \"pre_install\", run: phases.pre_install.join(\"\\n\") },\n                { step_name: \"INSTALL\", stage: \"install\", run: phases.install.join(\"\\n\") },\n                { step_name: \"PRE-BUILD\", stage: \"pre_build\", run: phases.pre_build.join(\"\\n\") },\n                { step_name: \"BUILD\", stage: \"build\", run: phases.build.join(\"\\n\") },\n                { step_name: \"TEST\", stage: \"test\", run: phases.test.join(\"\\n\") },\n                { step_name: \"POST\", stage: \"post\", run: phases.post.join(\"\\n\") },\n                { step_name: \"PUBLISH\", stage: \"publish\", run: phases.publish.join(\"\\n\")}\n            ]\n        };\n\n        return { plan, matrix };\n    }\n\n    private static buildPhases(args: {\n        workspace: string;\n        workingDirectory: string;\n        runtime: Runtime;\n        goal: Goal;\n    }): Phases {\n        const { workspace, workingDirectory, runtime, goal } = args;\n        const wd = join(workspace, workingDirectory);\n\n        const phases: Phases = {\n            pre_install: [],\n            install: [],\n            pre_build: [],\n            build: [],\n            test: [],\n            post: [],\n            publish: []\n        };\n\n        if (runtime === \"node\") {\n            const hasLock = fileExists(join(wd, \"package-lock.json\")) || fileExists(join(workspace, \"package-lock.json\"));\n            phases.pre_install.push('echo \"NODE_OPTIONS=--max-old-space-size=4096\" >> $GITHUB_ENV');\n            phases.install.push(hasLock ? \"npm ci\" : \"npm install\");\n            phases.test.push(\"npm test --if-present\");\n            phases.build.push(\"npm run build --if-present\");\n            return phases;\n        }\n\n        if (runtime === \"python\") {\n            const bases = [wd, workspace];\n            let req: string | null = null;\n\n            for (const base of bases) {\n                const files = listDir(base);\n                const found = files.find(f => /^requirements.*\\.txt$/i.test(f));\n                if (found) { req = found; break; }\n                if (fileExists(join(base, \"requirements.txt\"))) { req = \"requirements.txt\"; break; }\n            }\n\n            if (req) phases.install.push(`python -m pip install -r ${req}`);\n            phases.test.push(\"pytest -q\");\n            return phases;\n        }\n\n        if (runtime === \"go\") {\n            phases.test.push(\"go test ./...\");\n            if (goal !== \"pr-check\") phases.build.push(\"go build ./...\");\n            return phases;\n        }\n\n        const tool = this.detectJavaTool(workspace, workingDirectory);\n        if (tool === \"maven\") {\n            phases.test.push(\"mvn -B test\");\n            phases.build.push(\"mvn -B -DskipTests package\");\n        } else if (tool === \"gradle-wrapper\") {\n            phases.test.push(\"./gradlew test\");\n            phases.build.push(\"./gradlew build -x test\");\n        } else {\n            phases.test.push(\"gradle test\");\n            phases.build.push(\"gradle build -x test\");\n        }\n        return phases;\n    }\n\n    private static detectJavaTool(workspace: string, workingDirectory: string): \"maven\" | \"gradle\" | \"gradle-wrapper\" {\n        const wd = join(workspace, workingDirectory);\n        const bases = [wd, workspace];\n\n        for (const base of bases) {\n            if (fileExists(join(base, \"pom.xml\"))) return \"maven\";\n            if (fileExists(join(base, \"build.gradle\")) || fileExists(join(base, \"build.gradle.kts\"))) {\n                if (fileExists(join(base, \"gradlew\"))) return \"gradle-wrapper\";\n                return \"gradle\";\n            }\n        }\n        return \"maven\";\n    }\n\n    private static defaultArtifacts(runtime: Runtime): string[] {\n        if (runtime === \"node\") return [\"dist/**\", \"coverage/**\"];\n        if (runtime === \"python\") return [\"coverage/**\", \"test-results/**\"];\n        if (runtime === \"go\") return [\"coverage/**\"];\n        return [\"target/**\", \"build/**\", \"**/surefire-reports/**\", \"**/test-results/**\"];\n    }\n}"],"mappings":"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","names":["core","fs","path","fileExists","p","readText","listDir","dir","join","yaml","parseYaml","text","obj","IuPipesReader","workspace","p","join","raw","readText","parseYaml","RuntimeDetector","workspace","workingDirectory","bases","join","base","fileExists","listDir","f","RuntimeVersionResolver","params","workspace","workingDirectory","runtime","wd","join","tryRead","rel","readText","nvmrc","v","pkgRaw","eng","m","gomod","pyv","version","PlanBuilder","params","workspace","workingDirectory","runtime","runtimeVersion","goal","project","phases","plan","matrix","args","wd","join","hasLock","fileExists","bases","req","base","found","listDir","f","tool","normalizeWorkingDir","wd","cleaned","normalizeGoal","g","v","normalizeRuntime","r","run","workspace","project","IuPipesReader","workingDirectory","goal","runtime","RuntimeDetector","rv","runtimeVersion","RuntimeVersionResolver","plan","matrix","PlanBuilder","e"]}